# ADR: 0008 - Inventory/Accounting - Cost Maintenance Architecture - Visual Guide - Clarification Response

**Status:** âœ… Accepted  
**Date:** 2026-01-13  
**Context:** Which domain(s) maintain the cost structure for the system?
**Stakeholders:** Architecture team, Inventory domain owner, Accounting domain owner, Workexec domain owner
---

# Cost Maintenance Architecture - Visual Guide

## ğŸ—ï¸  Architecture: Dual Ownership Pattern

### High-Level System Overview

```ascii
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         POS System                              â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚                  â”‚              â”‚                  â”‚       â”‚
â”‚  â”‚   Inventory      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   Accounting     â”‚       â”‚
â”‚  â”‚   Service        â”‚              â”‚   Service        â”‚       â”‚
â”‚  â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                  â”‚       â”‚
â”‚  â”‚  (Data Owner)    â”‚              â”‚ (Logic Owner)    â”‚       â”‚
â”‚  â”‚                  â”‚              â”‚                  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚           â”‚                                 â”‚                  â”‚
â”‚           â”‚                                 â”‚                  â”‚
â”‚           â–¼                                 â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Product DB      â”‚              â”‚ ItemCostAudit DB â”‚       â”‚
â”‚  â”‚  - standardCost  â”‚              â”‚ - auditId        â”‚       â”‚
â”‚  â”‚  - lastCost      â”‚              â”‚ - oldValue       â”‚       â”‚
â”‚  â”‚  - averageCost   â”‚              â”‚ - newValue       â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Purchase Order Receipt Flow (Detailed)

### Sequence: How Costs Get Updated

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    PO    â”‚   â”‚  Message  â”‚   â”‚Accountingâ”‚   â”‚Inventory â”‚   â”‚  Audit   â”‚
â”‚  System  â”‚   â”‚   Bus     â”‚   â”‚ Service  â”‚   â”‚ Service  â”‚   â”‚   DB     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚               â”‚              â”‚              â”‚              â”‚
     â”‚ 1. Receive PO â”‚              â”‚              â”‚              â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º              â”‚              â”‚              â”‚
     â”‚               â”‚              â”‚              â”‚              â”‚
     â”‚               â”‚ 2. Publish   â”‚              â”‚              â”‚
     â”‚               â”‚ PO Received  â”‚              â”‚              â”‚
     â”‚               â”‚    Event     â”‚              â”‚              â”‚
     â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º              â”‚              â”‚
     â”‚               â”‚              â”‚              â”‚              â”‚
     â”‚               â”‚              â”‚ 3. GET Current Costs        â”‚
     â”‚               â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚              â”‚
     â”‚               â”‚              â”‚              â”‚              â”‚
     â”‚               â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚              â”‚
     â”‚               â”‚              â”‚ 4. Return    â”‚              â”‚
     â”‚               â”‚              â”‚    Costs     â”‚              â”‚
     â”‚               â”‚              â”‚              â”‚              â”‚
     â”‚               â”‚        â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”        â”‚              â”‚
     â”‚               â”‚        â”‚ Calculate â”‚        â”‚              â”‚
     â”‚               â”‚        â”‚ Last Cost â”‚        â”‚              â”‚
     â”‚               â”‚        â”‚ Avg  Cost â”‚        â”‚              â”‚
     â”‚               â”‚        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚              â”‚
     â”‚               â”‚              â”‚              â”‚              â”‚
     â”‚               â”‚              â”‚ 5. PUT Update Costs         â”‚
     â”‚               â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚              â”‚
     â”‚               â”‚              â”‚              â”‚              â”‚
     â”‚               â”‚              â”‚              â”‚ 6. Persist   â”‚
     â”‚               â”‚              â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚
     â”‚               â”‚              â”‚              â”‚              â”‚
     â”‚               â”‚              â”‚              â”‚ 7. Event     â”‚
     â”‚               â”‚              â”‚              â”‚ Cost Changed â”‚
     â”‚               â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚
     â”‚               â”‚              â”‚              â”‚              â”‚
     â”‚               â”‚              â”‚ 8. Create Audit Entries    â”‚
     â”‚               â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
     â”‚               â”‚              â”‚              â”‚              â”‚
     â”‚               â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     â”‚               â”‚              â”‚ 9. Success   â”‚              â”‚
     â”‚               â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚              â”‚
     â”‚               â”‚ 10. Complete â”‚              â”‚              â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚              â”‚              â”‚
     â”‚ 11. Ack       â”‚              â”‚              â”‚              â”‚
     â”‚               â”‚              â”‚              â”‚              â”‚
```

---

## ğŸ“¦ Data Ownership Diagram

### Clear Boundaries: What Each Domain Owns

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     INVENTORY DOMAIN                            â”‚
â”‚                                                                 â”‚
â”‚  Responsibilities:                                              â”‚
â”‚  âœ“ Store cost fields in Product entity                         â”‚
â”‚  âœ“ Provide CRUD APIs for cost data                             â”‚
â”‚  âœ“ Enforce authorization (who can update Standard Cost)        â”‚
â”‚  âœ“ Validate cost values (non-negative, 4 decimal places)       â”‚
â”‚  âœ“ Publish ItemCostChanged events for audit                    â”‚
â”‚                                                                 â”‚
â”‚  Does NOT own:                                                  â”‚
â”‚  âœ— Cost calculation logic                                       â”‚
â”‚  âœ— Purchase Order event handling                               â”‚
â”‚  âœ— Weighted average formula                                    â”‚
â”‚                                                                 â”‚
â”‚  APIs Exposed:                                                  â”‚
â”‚  â€¢ GET  /api/inventory/items/{id}/costs                        â”‚
â”‚  â€¢ PUT  /api/inventory/items/{id}/costs/standard (manual)      â”‚
â”‚  â€¢ PUT  /api/inventory/items/{id}/costs/system-update (system) â”‚
â”‚                                                                 â”‚
â”‚  Events Published:                                              â”‚
â”‚  â€¢ ItemCostChanged (for audit)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                â–²
                                â”‚
                                â”‚ REST API Call
                                â”‚ (System Update)
                                â”‚
                                â”‚
                                â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ACCOUNTING DOMAIN                            â”‚
â”‚                                                                 â”‚
â”‚  Responsibilities:                                              â”‚
â”‚  âœ“ Subscribe to PurchaseOrderReceived events                   â”‚
â”‚  âœ“ Implement Last Cost calculation (direct assignment)         â”‚
â”‚  âœ“ Implement Average Cost calculation (weighted average)       â”‚
â”‚  âœ“ Call Inventory API to update costs                          â”‚
â”‚  âœ“ Create audit log entries for all changes                    â”‚
â”‚  âœ“ Handle errors and retry logic                               â”‚
â”‚                                                                 â”‚
â”‚  Does NOT own:                                                  â”‚
â”‚  âœ— Cost data storage                                            â”‚
â”‚  âœ— Product entity                                               â”‚
â”‚  âœ— Standard Cost manual updates                                â”‚
â”‚                                                                 â”‚
â”‚  Events Consumed:                                               â”‚
â”‚  â€¢ PurchaseOrderReceived (from PO system)                       â”‚
â”‚                                                                 â”‚
â”‚  APIs Called:                                                   â”‚
â”‚  â€¢ GET  /api/inventory/items/{id}/costs (to get current)       â”‚
â”‚  â€¢ PUT  /api/inventory/items/{id}/costs/system-update          â”‚
â”‚                                                                 â”‚
â”‚  Data Owned:                                                    â”‚
â”‚  â€¢ ItemCostAudit table (audit trail)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Cost Types and Their Update Rules

### Three Cost Types with Different Update Mechanisms

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Cost Types                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. STANDARD COST                                               â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚     â”‚ â€¢ Manually set by authorized users          â”‚            â”‚
â”‚     â”‚ â€¢ Planned/predetermined cost                â”‚            â”‚
â”‚     â”‚ â€¢ Updated via Inventory API                 â”‚            â”‚
â”‚     â”‚ â€¢ Requires authorization (Inventory Manager)â”‚            â”‚
â”‚     â”‚ â€¢ Use case: Budgeting, variance analysis    â”‚            â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                 â”‚
â”‚  2. LAST COST                                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚     â”‚ â€¢ Automatically updated on PO receipt        â”‚            â”‚
â”‚     â”‚ â€¢ Most recent purchase unit cost            â”‚            â”‚
â”‚     â”‚ â€¢ Formula: lastCost = receivedUnitCost      â”‚            â”‚
â”‚     â”‚ â€¢ Updated by Accounting service             â”‚            â”‚
â”‚     â”‚ â€¢ Use case: Quick reference, vendor pricing â”‚            â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                 â”‚
â”‚  3. AVERAGE COST                                                â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚     â”‚ â€¢ Automatically updated on PO receipt        â”‚            â”‚
â”‚     â”‚ â€¢ Weighted average of all units in stock    â”‚            â”‚
â”‚     â”‚ â€¢ Formula: ((oldQty * oldAvg) +             â”‚            â”‚
â”‚     â”‚            (recQty * recCost)) /            â”‚            â”‚
â”‚     â”‚            (oldQty + recQty)                â”‚            â”‚
â”‚     â”‚ â€¢ Updated by Accounting service             â”‚            â”‚
â”‚     â”‚ â€¢ Use case: COGS, inventory valuation       â”‚            â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Authorization and Security

### Who Can Do What?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     User Roles & Permissions                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  INVENTORY MANAGER                                          â”‚
â”‚  âœ“ Read all cost data                                      â”‚
â”‚  âœ“ Manually update Standard Cost                           â”‚
â”‚  âœ— Cannot update Last Cost (system-only)                   â”‚
â”‚  âœ— Cannot update Average Cost (system-only)                â”‚
â”‚                                                             â”‚
â”‚  ACCOUNTING MANAGER                                         â”‚
â”‚  âœ“ Read all cost data                                      â”‚
â”‚  âœ“ View audit logs                                         â”‚
â”‚  âœ“ Run financial reports                                   â”‚
â”‚  âœ— Cannot manually update any costs (read-only)            â”‚
â”‚                                                             â”‚
â”‚  SYSTEM (Accounting Service)                                â”‚
â”‚  âœ“ Read all cost data                                      â”‚
â”‚  âœ“ Update Last Cost (via PO events)                        â”‚
â”‚  âœ“ Update Average Cost (via PO events)                     â”‚
â”‚  âœ“ Create audit log entries                                â”‚
â”‚  âœ— Cannot update Standard Cost (user-only)                 â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Example: Purchase Order Receipt

### Real-World Scenario with Numbers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Initial State                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚
â”‚  Item ID: TIRE-12345                                        â”‚
â”‚  Quantity On Hand: 100 units                                â”‚
â”‚  Standard Cost: $50.00 (set by manager)                     â”‚
â”‚  Last Cost: $45.00 (from previous PO)                       â”‚
â”‚  Average Cost: $47.00 (weighted average)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ PO Received Event
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Purchase Order Received                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚
â”‚  PO Number: PO-2024-001                                     â”‚
â”‚  Item ID: TIRE-12345                                        â”‚
â”‚  Received Quantity: 50 units                                â”‚
â”‚  Received Unit Cost: $48.00                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Accounting Service
                         â”‚ Calculates New Costs
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Calculations                                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                               â”‚
â”‚                                                             â”‚
â”‚  Last Cost = $48.00 (direct assignment)                     â”‚
â”‚                                                             â”‚
â”‚  Average Cost = ((100 Ã— $47.00) + (50 Ã— $48.00))          â”‚
â”‚                 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”‚
â”‚                        (100 + 50)                           â”‚
â”‚                                                             â”‚
â”‚               = ($4,700 + $2,400) / 150                    â”‚
â”‚               = $7,100 / 150                               â”‚
â”‚               = $47.3333                                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Update Inventory
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Final State                                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚
â”‚  Item ID: TIRE-12345                                        â”‚
â”‚  Quantity On Hand: 150 units (100 + 50)                     â”‚
â”‚  Standard Cost: $50.00 (unchanged)                          â”‚
â”‚  Last Cost: $48.00 (updated) â—„â”€â”€ Changed                   â”‚
â”‚  Average Cost: $47.3333 (updated) â—„â”€â”€ Changed              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Audit Logs Created
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Audit Trail                                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚
â”‚                                                             â”‚
â”‚  Entry 1:                                                   â”‚
â”‚  - Cost Type: LAST                                          â”‚
â”‚  - Old Value: $45.00                                        â”‚
â”‚  - New Value: $48.00                                        â”‚
â”‚  - Source: PO-2024-001                                      â”‚
â”‚  - Actor: system                                            â”‚
â”‚  - Timestamp: 2026-01-13T10:30:00Z                          â”‚
â”‚                                                             â”‚
â”‚  Entry 2:                                                   â”‚
â”‚  - Cost Type: AVERAGE                                       â”‚
â”‚  - Old Value: $47.00                                        â”‚
â”‚  - New Value: $47.3333                                      â”‚
â”‚  - Source: PO-2024-001                                      â”‚
â”‚  - Actor: system                                            â”‚
â”‚  - Timestamp: 2026-01-13T10:30:00Z                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Benefits of This Architecture

### Why Dual Ownership Works

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Key Benefits                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  âœ… Clear Boundaries                                    â”‚
â”‚     Each domain has a single, well-defined purpose      â”‚
â”‚                                                         â”‚
â”‚  âœ… Independent Testing                                 â”‚
â”‚     Can test data layer separately from business logic  â”‚
â”‚                                                         â”‚
â”‚  âœ… Independent Deployment                              â”‚
â”‚     Can deploy services independently                   â”‚
â”‚                                                         â”‚
â”‚  âœ… Maintainability                                     â”‚
â”‚     Changes to cost logic don't affect Inventory        â”‚
â”‚                                                         â”‚
â”‚  âœ… Scalability                                         â”‚
â”‚     Can scale services based on different needs         â”‚
â”‚                                                         â”‚
â”‚  âœ… Follows DDD Principles                              â”‚
â”‚     Bounded contexts with clear integration             â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

